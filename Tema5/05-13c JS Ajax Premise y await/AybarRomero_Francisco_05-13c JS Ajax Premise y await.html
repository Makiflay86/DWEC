<!doctype html>
<html lang="es-ES">
    <head>
        <title>AybarRomero_Francisco_05-13c JS Ajax Premise y await</title>
        <!-- Required meta tags -->
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />

        <!-- Bootstrap CSS v5.2.1 -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
            crossorigin="anonymous"
        />
    </head>

    <body>
        
        <div class="container my-5">
            <div class="row justify-content-center">
                <div class="col-12 col-md-8 col-lg-6">

                    <section class="my-3 pt-3 rounded shadow bg-info-subtle">
                        <div class="text-center mb-3">
                            <h1>Ejercicio 1</h1>
                            <hr class="border border-primary w-25 mx-auto">
                        </div>
                        <article class="bg-primary-subtle p-5 rounded">

                            <div id="ej1"></div>

                            <script>
                                async function cargarDatosSecuencialmente() 
                                {
                                    let output = document.getElementById("ej1");
                                    const inicio = Date.now();
                                    ej1.innerHTML += "-> Iniciando carga secuencial...<br>";

                                    /* Articulo */
                                    ej1.innerHTML += "Cargando articulo...<br>";
                                    const articulo = await new Promise(resolve => { 
                                        setTimeout(async () => { 
                                            const respuesta = await fetch("./src/articulos-recientes.json"); 
                                            const datos = await respuesta.json(); 
                                            resolve(datos); 
                                        }, 1500); // 1,5 segundos
                                    });
                                    ej1.innerHTML += "Articulo cargado.<br>";

                                    /* Venta */
                                    ej1.innerHTML += "Cargando ventas del mes...<br>";
                                    const venta = await new Promise(resolve => { 
                                        setTimeout(async () => { 
                                            const respuesta = await fetch("./src/ventas.json"); 
                                            const datos = await respuesta.json(); 
                                            resolve(datos); 
                                        }, 2000); // 2 segundos
                                    });
                                    ej1.innerHTML += "Ventas del mes cargado.<br>";
                                    
                                    /* Img perfil */
                                    ej1.innerHTML += "Cargando imagen de perfil...<br>";
                                    const imgPerfil = await new Promise(resolve => { 
                                        setTimeout(async () => { 
                                            const respuesta = await fetch("./src/img.json"); 
                                            const datos = await respuesta.json(); 
                                            resolve(datos); 
                                        }, 500); // 0,5 segundos
                                    });
                                    ej1.innerHTML += "Imágen perfil cargada.<br>";

                                    const fin = Date.now();
                                    ej1.innerHTML += "================================<br>";
                                    ej1.innerHTML += `⏱️ Finalizado en: ${(fin - inicio) / 1000} segundos.<br>`;
                                    ej1.innerHTML += `Resultado final:<br>
                                        · Articulo: ${articulo.nombre} - ${articulo.precio}€<br>
                                        · Venta: ${venta.nombre} - ${venta.precio}€<br>
                                        · Imágen perfil: ${imgPerfil.nombre} - ${imgPerfil.url}                                        
                                    `;
                                }

                                cargarDatosSecuencialmente(); 
                            </script>

                        </article>
                    </section>



                    <section class="my-3 pt-3 rounded shadow bg-info-subtle">
                        <div class="text-center mb-3">
                            <h1>Ejercicio 2</h1>
                            <hr class="border border-primary w-25 mx-auto">
                        </div>
                        <article class="bg-primary-subtle p-5 rounded">

                            <div id="ej2"></div>

                            <script>
                                async function cargarDatosSecuencialmente() 
                                {
                                    try
                                    {
                                        let output = document.getElementById("ej1");
                                        const inicio = Date.now();
                                        ej2.innerHTML += "-> Iniciando carga secuencial...<br>";

                                        /* Articulo */
                                        ej2.innerHTML += "Cargando articulo...<br>";
                                        const articulo = await new Promise(resolve => { 
                                            setTimeout(async () => { 
                                                const respuesta = await fetch("./src/articulos-recientes.json"); 
                                                const datos = await respuesta.json(); 
                                                resolve(datos); 
                                            }, 1500); // 1,5 segundos
                                        });
                                        ej2.innerHTML += "Articulo cargado.<br>";

                                        /* Venta */
                                        ej2.innerHTML += "Cargando ventas del mes...<br>";
                                        const venta = await new Promise(resolve => { 
                                            setTimeout(async () => { 
                                                const respuesta = await fetch("./src/ventas.json"); 
                                                const datos = await respuesta.json(); 
                                                resolve(datos); 
                                            }, 2000); // 2 segundos
                                        });
                                        ej2.innerHTML += "Ventas del mes cargado.<br>";
                                        
                                        /* Img perfil */
                                        ej2.innerHTML += "Cargando imagen de perfil...<br>";
                                        const imgPerfil = await new Promise(resolve => { 
                                            setTimeout(async () => { 
                                                const respuesta = await fetch("./src/img.json"); 
                                                const datos = await respuesta.json(); 
                                                resolve(datos); 
                                            }, 500); // 0,5 segundos
                                        });
                                        ej2.innerHTML += "Imágen perfil cargada.<br>";

                                        const fin = Date.now();
                                        ej2.innerHTML += "================================<br>";
                                        ej2.innerHTML += `⏱️ Finalizado en: ${(fin - inicio) / 1000} segundos.<br>`;
                                        ej2.innerHTML += `Resultado final:<br>
                                            · Articulo: ${articulo.nombre} - ${articulo.precio}€<br>
                                            · Venta: ${venta.nombre} - ${venta.precio}€<br>
                                            · Imágen perfil: ${imgPerfil.nombre} - ${imgPerfil.url}                                        
                                        `;
                                        
                                    }
                                    catch(error)
                                    {
                                        ej2.innerHTML = `ERROR: ${error}`;
                                    }
                                }

                                cargarDatosSecuencialmente(); 
                            </script>

                        </article>
                    </section>



                    <section class="my-3 pt-3 rounded shadow bg-info-subtle">
                        <div class="text-center mb-3">
                            <h1>Ejercicio 3</h1>
                            <hr class="border border-primary w-25 mx-auto">
                        </div>
                        <article class="bg-primary-subtle p-5 rounded">

                            

                        </article>
                    </section>

                </div>
            </div>
        </div>
        
        <!-- Bootstrap JavaScript Libraries -->
        <script
            src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            crossorigin="anonymous"
        ></script>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
            integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
            crossorigin="anonymous"
        ></script>
    </body>
</html>
